Data from the single-cell assay for transposase-accessible chromatin using sequencing (scATAC-seq) is now widely available. This data is used to uncover complex regulatory networks at the single-cell level, elucidating the cellular mechanisms that drive cell-to-cell heterogeneity. The power of scATAC-seq data has motivated the development of new computational approaches for its analysis @Xiong2019 @Yuan2022 @Schep2017 @BravoGonzález-Blas2019 @Granja2021 @Cusanovich2018 @Ashuach2022 @Li2022 @Fang2021a @Mezger2018 @Baker2019 @Ma2023. Despite these advances, scATAC-seq analysis continues to face two key challenges: the 1) high dimensionality and 2) inherent sparsity of the data @Chen2019a @Baek2020.  

scATAC-seq analysis often includes two critical tasks: 1) dimensionality reduction followed by clustering and 2) cell-type annotation of cell clusters. For the dimensionality reduction task, numerous methods have been developed, such as SCALE and scBasset, which use variational autoencoders and convolutional neural networks to learn low-dimensional representations of single cells for downstream clustering tasks @Xiong2019 @Yuan2022. Other methods include ChromVAR, cisTopic, SnapATAC, and ArchR, which leverage latent semantic analysis (LSI) and topic modeling to cluster individual cells @Schep2017 @BravoGonzález-Blas2019 @Granja2021. These methods usually require complex processing pipelines and large compute power. The second task, cell-type annotation, is less well-served, with most current methods simply repurposing cell-type annotation tools from scRNA-seq @Wang2022. Methods developed for scATAC are few and suffer notable limitations. First, they mainly take a cross-modality approach, integrating data from reference scRNA-seq sets, so they are limited in relying on a secondary data modality. Finding an appropriate secondary dataset to complement the unlabeled set can be difficult @Lin2022. Second, many supervised methods -- while powerful -- require model training to predict cell types from a fixed output. This can make the discovery of novel cell types a challenge @Ma2023. Finally, these methods are notoriously compute-intensive @Chen2022, a limitation that has grown more problematic as atlas-level datasets have emerged. This problem is further compounded by the fact that many researchers seek to integrate multiple scATAC-seq datasets, which can be computationally prohibitive with current methods.

Here, we address these challenges with an alternative approach to scATAC-seq dimensionality reduction and cell-type annotation using pre-trained embedding models. As discussed in previous chapters, the development of foundation models for scATAC-seq has been hindered by the lack of standardized vocabularies and the challenge of creating meaningful token representations for genomic regions. A natural first step toward building such foundation models is to investigate whether genomic regions can be effectively represented as discrete token embeddings, analogous to word embeddings in natural language processing. scEmbed explores this foundational question by learning fixed, low-dimensional representations of genomic regions that can be shared across datasets, validating the discrete tokenization approach and establishing baseline performance for transfer learning in chromatin accessibility analysis.

Our method improves both dimensionality reduction and cell-type annotation by significantly reducing the computational time and complexity of these workflows with the added benefit of leveraging information from high-quality reference datasets. Instead of analyzing datasets end to end, we use unsupervised learning to model the patterns of regulatory region co-occurrence in high-quality reference datasets, and then transfer this knowledge to new, unseen data. We implemented this method in scEmbed, an unsupervised machine-learning method that learns low-dimensional representations of genomic regions from scATAC-seq datasets. We first show that scEmbed performs as well as established methods for dimensionality reduction and clustering while maintaining robustness to data loss. Moreover, by leveraging models pre-trained on reference data, scEmbed drastically reduces the time and complexity of scATAC-seq analysis with little to no loss in clustering performance. Finally, we build a novel cell-type annotation system by exploiting the learned embeddings produced by pre-trained embedding models without needing any external data modalities. Our system can accurately annotate unseen data in seconds using pre-trained reference models. scEmbed takes a new approach to scATAC-seq analysis by focusing on ATAC-seq data alone, while building high-quality embeddings of genomic regions en route to single-cells, which offers flexibility and speed for a wide range of downstream tasks.